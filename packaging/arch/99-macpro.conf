# linux-mac: Mac Pro 6,1 Performance Tuning
# Install to /etc/sysctl.d/99-macpro.conf

# --- Memory (tuned for 64GB RAM) ---
# Almost never touch swap with this much RAM
vm.swappiness = 10
# Keep filesystem caches longer, reduce disk reads
vm.vfs_cache_pressure = 50
# Start writing dirty pages at 10% of RAM (~6.4GB)
vm.dirty_ratio = 10
# Background writeback starts at ~3.2GB dirty
vm.dirty_background_ratio = 5

# --- Network (tuned for dual GbE) ---
# Larger socket buffers for throughput
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
# TCP Fast Open for client + server
net.ipv4.tcp_fastopen = 3
# Handle burst traffic
net.core.netdev_max_backlog = 5000
# Google BBR congestion control (requires CONFIG_TCP_CONG_BBR=y)
net.ipv4.tcp_congestion_control = bbr

# --- Kernel ---
# Reduce console log noise (especially Thunderbolt spam)
# Format: console_loglevel default_message_loglevel minimum_console_loglevel default_console_loglevel
kernel.printk = 3 4 1 3
